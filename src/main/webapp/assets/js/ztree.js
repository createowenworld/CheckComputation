/*! CreditChina | 2016 Baidu Inc. All Rights Reserved. */
!function($){var settings={},roots={},caches={},_consts={className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error",REMOVE:"ztree_remove"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_setting={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0,txtSelectedEnable:!1},data:{key:{children:"children",name:"name",title:"",url:"url"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},_initRoot=function(e){var t=data.getRoot(e);if(!t)t={},data.setRoot(e,t);t[e.data.key.children]=[],t.expandTriggerFlag=!1,t.curSelectedList=[],t.noSelection=!0,t.createdNodes=[],t.zId=0,t._ver=(new Date).getTime()},_initCache=function(e){var t=data.getCache(e);if(!t)t={},data.setCache(e,t);t.nodes=[],t.doms=[]},_bindEvent=function(e){var t=e.treeObj,i=consts.event;t.bind(i.NODECREATED,function(t,i,n){tools.apply(e.callback.onNodeCreated,[t,i,n])}),t.bind(i.CLICK,function(t,i,n,r,o){tools.apply(e.callback.onClick,[i,n,r,o])}),t.bind(i.EXPAND,function(t,i,n){tools.apply(e.callback.onExpand,[t,i,n])}),t.bind(i.COLLAPSE,function(t,i,n){tools.apply(e.callback.onCollapse,[t,i,n])}),t.bind(i.ASYNC_SUCCESS,function(t,i,n,r){tools.apply(e.callback.onAsyncSuccess,[t,i,n,r])}),t.bind(i.ASYNC_ERROR,function(t,i,n,r,o,a){tools.apply(e.callback.onAsyncError,[t,i,n,r,o,a])}),t.bind(i.REMOVE,function(t,i,n){tools.apply(e.callback.onRemove,[t,i,n])})},_unbindEvent=function(e){var t=e.treeObj,i=consts.event;t.unbind(i.NODECREATED).unbind(i.CLICK).unbind(i.EXPAND).unbind(i.COLLAPSE).unbind(i.ASYNC_SUCCESS).unbind(i.ASYNC_ERROR).unbind(i.REMOVE)},_eventProxy=function(e){var t=e.target,i=data.getSetting(e.data.treeId),n="",r=null,o="",a="",s=null,l=null,u=null;if(tools.eqs(e.type,"mousedown"))a="mousedown";else if(tools.eqs(e.type,"mouseup"))a="mouseup";else if(tools.eqs(e.type,"contextmenu"))a="contextmenu";else if(tools.eqs(e.type,"click")){if(tools.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+consts.id.SWITCH))n=tools.getNodeMainDom(t).id,o="switchNode";else if(u=tools.getMDom(i,t,[{tagName:"a",attrName:"treeNode"+consts.id.A}]))n=tools.getNodeMainDom(u).id,o="clickNode"}else if(tools.eqs(e.type,"dblclick"))if(a="dblclick",u=tools.getMDom(i,t,[{tagName:"a",attrName:"treeNode"+consts.id.A}]))n=tools.getNodeMainDom(u).id,o="switchNode";if(a.length>0&&0==n.length)if(u=tools.getMDom(i,t,[{tagName:"a",attrName:"treeNode"+consts.id.A}]))n=tools.getNodeMainDom(u).id;if(n.length>0)switch(r=data.getNodeCache(i,n),o){case"switchNode":if(!r.isParent)o="";else if(tools.eqs(e.type,"click")||tools.eqs(e.type,"dblclick")&&tools.apply(i.view.dblClickExpand,[i.treeId,r],i.view.dblClickExpand))s=handler.onSwitchNode;else o="";break;case"clickNode":s=handler.onClickNode}switch(a){case"mousedown":l=handler.onZTreeMousedown;break;case"mouseup":l=handler.onZTreeMouseup;break;case"dblclick":l=handler.onZTreeDblclick;break;case"contextmenu":l=handler.onZTreeContextmenu}var c={stop:!1,node:r,nodeEventType:o,nodeEventCallback:s,treeEventType:a,treeEventCallback:l};return c},_initNode=function(e,t,i,n,r,o,a){if(i){var s=data.getRoot(e),l=e.data.key.children;if(i.level=t,i.tId=e.treeId+"_"+ ++s.zId,i.parentTId=n?n.tId:null,i.open="string"==typeof i.open?tools.eqs(i.open,"true"):!!i.open,i[l]&&i[l].length>0)i.isParent=!0,i.zAsync=!0;else i.isParent="string"==typeof i.isParent?tools.eqs(i.isParent,"true"):!!i.isParent,i.open=i.isParent&&!e.async.enable?i.open:!1,i.zAsync=!i.isParent;i.isFirstNode=r,i.isLastNode=o,i.getParentNode=function(){return data.getNodeCache(e,i.parentTId)},i.getPreNode=function(){return data.getPreNode(e,i)},i.getNextNode=function(){return data.getNextNode(e,i)},i.isAjaxing=!1,data.fixPIdKeyValue(e,i)}},_init={bind:[_bindEvent],unbind:[_unbindEvent],caches:[_initCache],nodes:[_initNode],proxys:[_eventProxy],roots:[_initRoot],beforeA:[],afterA:[],innerBeforeA:[],innerAfterA:[],zTreeTools:[]},data={addNodeCache:function(e,t){data.getCache(e).nodes[data.getNodeCacheId(t.tId)]=t},getNodeCacheId:function(e){return e.substring(e.lastIndexOf("_")+1)},addAfterA:function(e){_init.afterA.push(e)},addBeforeA:function(e){_init.beforeA.push(e)},addInnerAfterA:function(e){_init.innerAfterA.push(e)},addInnerBeforeA:function(e){_init.innerBeforeA.push(e)},addInitBind:function(e){_init.bind.push(e)},addInitUnBind:function(e){_init.unbind.push(e)},addInitCache:function(e){_init.caches.push(e)},addInitNode:function(e){_init.nodes.push(e)},addInitProxy:function(e,t){if(t)_init.proxys.splice(0,0,e);else _init.proxys.push(e)},addInitRoot:function(e){_init.roots.push(e)},addNodesData:function(e,t,i){var n=e.data.key.children;if(!t[n])t[n]=[];if(t[n].length>0)t[n][t[n].length-1].isLastNode=!1,view.setNodeLineIcos(e,t[n][t[n].length-1]);t.isParent=!0,t[n]=t[n].concat(i)},addSelectedNode:function(e,t){var i=data.getRoot(e);if(!data.isSelectedNode(e,t))i.curSelectedList.push(t)},addCreatedNode:function(e,t){if(e.callback.onNodeCreated||e.view.addDiyDom){var i=data.getRoot(e);i.createdNodes.push(t)}},addZTreeTools:function(e){_init.zTreeTools.push(e)},exSetting:function(e){$.extend(!0,_setting,e)},fixPIdKeyValue:function(e,t){if(e.data.simpleData.enable)t[e.data.simpleData.pIdKey]=t.parentTId?t.getParentNode()[e.data.simpleData.idKey]:e.data.simpleData.rootPId},getAfterA:function(e,t,i){for(var n=0,r=_init.afterA.length;r>n;n++)_init.afterA[n].apply(this,arguments)},getBeforeA:function(e,t,i){for(var n=0,r=_init.beforeA.length;r>n;n++)_init.beforeA[n].apply(this,arguments)},getInnerAfterA:function(e,t,i){for(var n=0,r=_init.innerAfterA.length;r>n;n++)_init.innerAfterA[n].apply(this,arguments)},getInnerBeforeA:function(e,t,i){for(var n=0,r=_init.innerBeforeA.length;r>n;n++)_init.innerBeforeA[n].apply(this,arguments)},getCache:function(e){return caches[e.treeId]},getNextNode:function(e,t){if(!t)return null;for(var i=e.data.key.children,n=t.parentTId?t.getParentNode():data.getRoot(e),r=0,o=n[i].length-1;o>=r;r++)if(n[i][r]===t)return r==o?null:n[i][r+1];return null},getNodeByParam:function(e,t,i,n){if(!t||!i)return null;for(var r=e.data.key.children,o=0,a=t.length;a>o;o++){if(t[o][i]==n)return t[o];var s=data.getNodeByParam(e,t[o][r],i,n);if(s)return s}return null},getNodeCache:function(e,t){if(!t)return null;var i=caches[e.treeId].nodes[data.getNodeCacheId(t)];return i?i:null},getNodeName:function(e,t){var i=e.data.key.name;return""+t[i]},getNodeTitle:function(e,t){var i=""===e.data.key.title?e.data.key.name:e.data.key.title;return""+t[i]},getNodes:function(e){return data.getRoot(e)[e.data.key.children]},getNodesByParam:function(e,t,i,n){if(!t||!i)return[];for(var r=e.data.key.children,o=[],a=0,s=t.length;s>a;a++){if(t[a][i]==n)o.push(t[a]);o=o.concat(data.getNodesByParam(e,t[a][r],i,n))}return o},getNodesByParamFuzzy:function(e,t,i,n){if(!t||!i)return[];var r=e.data.key.children,o=[];n=n.toLowerCase();for(var a=0,s=t.length;s>a;a++){if("string"==typeof t[a][i]&&t[a][i].toLowerCase().indexOf(n)>-1)o.push(t[a]);o=o.concat(data.getNodesByParamFuzzy(e,t[a][r],i,n))}return o},getNodesByFilter:function(e,t,i,n,r){if(!t)return n?null:[];for(var o=e.data.key.children,a=n?null:[],s=0,l=t.length;l>s;s++){if(tools.apply(i,[t[s],r],!1)){if(n)return t[s];a.push(t[s])}var u=data.getNodesByFilter(e,t[s][o],i,n,r);if(n&&u)return u;a=n?u:a.concat(u)}return a},getPreNode:function(e,t){if(!t)return null;for(var i=e.data.key.children,n=t.parentTId?t.getParentNode():data.getRoot(e),r=0,o=n[i].length;o>r;r++)if(n[i][r]===t)return 0==r?null:n[i][r-1];return null},getRoot:function(e){return e?roots[e.treeId]:null},getRoots:function(){return roots},getSetting:function(e){return settings[e]},getSettings:function(){return settings},getZTreeTools:function(e){var t=this.getRoot(this.getSetting(e));return t?t.treeTools:null},initCache:function(e){for(var t=0,i=_init.caches.length;i>t;t++)_init.caches[t].apply(this,arguments)},initNode:function(e,t,i,n,r,o){for(var a=0,s=_init.nodes.length;s>a;a++)_init.nodes[a].apply(this,arguments)},initRoot:function(e){for(var t=0,i=_init.roots.length;i>t;t++)_init.roots[t].apply(this,arguments)},isSelectedNode:function(e,t){for(var i=data.getRoot(e),n=0,r=i.curSelectedList.length;r>n;n++)if(t===i.curSelectedList[n])return!0;return!1},removeNodeCache:function(e,t){var i=e.data.key.children;if(t[i])for(var n=0,r=t[i].length;r>n;n++)arguments.callee(e,t[i][n]);data.getCache(e).nodes[data.getNodeCacheId(t.tId)]=null},removeSelectedNode:function(e,t){for(var i=data.getRoot(e),n=0,r=i.curSelectedList.length;r>n;n++)if(t===i.curSelectedList[n]||!data.getNodeCache(e,i.curSelectedList[n].tId))i.curSelectedList.splice(n,1),n--,r--},setCache:function(e,t){caches[e.treeId]=t},setRoot:function(e,t){roots[e.treeId]=t},setZTreeTools:function(e,t){for(var i=0,n=_init.zTreeTools.length;n>i;i++)_init.zTreeTools[i].apply(this,arguments)},transformToArrayFormat:function(e,t){if(!t)return[];var i=e.data.key.children,n=[];if(tools.isArray(t)){for(var r=0,o=t.length;o>r;r++)if(n.push(t[r]),t[r][i])n=n.concat(data.transformToArrayFormat(e,t[r][i]))}else if(n.push(t),t[i])n=n.concat(data.transformToArrayFormat(e,t[i]));return n},transformTozTreeFormat:function(e,t){var i,n,r=e.data.simpleData.idKey,o=e.data.simpleData.pIdKey,a=e.data.key.children;if(!r||""==r||!t)return[];if(tools.isArray(t)){var s=[],l=[];for(i=0,n=t.length;n>i;i++)l[t[i][r]]=t[i];for(i=0,n=t.length;n>i;i++)if(l[t[i][o]]&&t[i][r]!=t[i][o]){if(!l[t[i][o]][a])l[t[i][o]][a]=[];l[t[i][o]][a].push(t[i])}else s.push(t[i]);return s}else return[t]}},event={bindEvent:function(e){for(var t=0,i=_init.bind.length;i>t;t++)_init.bind[t].apply(this,arguments)},unbindEvent:function(e){for(var t=0,i=_init.unbind.length;i>t;t++)_init.unbind[t].apply(this,arguments)},bindTree:function(e){var t={treeId:e.treeId},i=e.treeObj;if(!e.view.txtSelectedEnable)i.bind("selectstart",function(e){var t=e.originalEvent.srcElement.nodeName.toLowerCase();return"input"===t||"textarea"===t}).css({"-moz-user-select":"-moz-none"});i.bind("click",t,event.proxy),i.bind("dblclick",t,event.proxy),i.bind("mouseover",t,event.proxy),i.bind("mouseout",t,event.proxy),i.bind("mousedown",t,event.proxy),i.bind("mouseup",t,event.proxy),i.bind("contextmenu",t,event.proxy)},unbindTree:function(e){var t=e.treeObj;t.unbind("click",event.proxy).unbind("dblclick",event.proxy).unbind("mouseover",event.proxy).unbind("mouseout",event.proxy).unbind("mousedown",event.proxy).unbind("mouseup",event.proxy).unbind("contextmenu",event.proxy)},doProxy:function(e){for(var t=[],i=0,n=_init.proxys.length;n>i;i++){var r=_init.proxys[i].apply(this,arguments);if(t.push(r),r.stop)break}return t},proxy:function(e){var t=data.getSetting(e.data.treeId);if(!tools.uCanDo(t,e))return!0;for(var i=event.doProxy(e),n=!0,r=!1,o=0,a=i.length;a>o;o++){var s=i[o];if(s.nodeEventCallback)r=!0,n=s.nodeEventCallback.apply(s,[e,s.node])&&n;if(s.treeEventCallback)r=!0,n=s.treeEventCallback.apply(s,[e,s.node])&&n}return n}},handler={onSwitchNode:function(e,t){var i=data.getSetting(e.data.treeId);if(t.open){if(0==tools.apply(i.callback.beforeCollapse,[i.treeId,t],!0))return!0;data.getRoot(i).expandTriggerFlag=!0,view.switchNode(i,t)}else{if(0==tools.apply(i.callback.beforeExpand,[i.treeId,t],!0))return!0;data.getRoot(i).expandTriggerFlag=!0,view.switchNode(i,t)}return!0},onClickNode:function(e,t){var i=data.getSetting(e.data.treeId),n=i.view.autoCancelSelected&&(e.ctrlKey||e.metaKey)&&data.isSelectedNode(i,t)?0:i.view.autoCancelSelected&&(e.ctrlKey||e.metaKey)&&i.view.selectedMulti?2:1;if(0==tools.apply(i.callback.beforeClick,[i.treeId,t,n],!0))return!0;if(0===n)view.cancelPreSelectedNode(i,t);else view.selectNode(i,t,2===n);return i.treeObj.trigger(consts.event.CLICK,[e,i.treeId,t,n]),!0},onZTreeMousedown:function(e,t){var i=data.getSetting(e.data.treeId);if(tools.apply(i.callback.beforeMouseDown,[i.treeId,t],!0))tools.apply(i.callback.onMouseDown,[e,i.treeId,t]);return!0},onZTreeMouseup:function(e,t){var i=data.getSetting(e.data.treeId);if(tools.apply(i.callback.beforeMouseUp,[i.treeId,t],!0))tools.apply(i.callback.onMouseUp,[e,i.treeId,t]);return!0},onZTreeDblclick:function(e,t){var i=data.getSetting(e.data.treeId);if(tools.apply(i.callback.beforeDblClick,[i.treeId,t],!0))tools.apply(i.callback.onDblClick,[e,i.treeId,t]);return!0},onZTreeContextmenu:function(e,t){var i=data.getSetting(e.data.treeId);if(tools.apply(i.callback.beforeRightClick,[i.treeId,t],!0))tools.apply(i.callback.onRightClick,[e,i.treeId,t]);return"function"!=typeof i.callback.onRightClick}},tools={apply:function(e,t,i){if("function"==typeof e)return e.apply(zt,t?t:[]);else return i},canAsync:function(e,t){var i=e.data.key.children;return e.async.enable&&t&&t.isParent&&!(t.zAsync||t[i]&&t[i].length>0)},clone:function(e){if(null===e)return null;var t=tools.isArray(e)?[]:{};for(var i in e)t[i]=e[i]instanceof Date?new Date(e[i].getTime()):"object"==typeof e[i]?arguments.callee(e[i]):e[i];return t},eqs:function(e,t){return e.toLowerCase()===t.toLowerCase()},isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},$:function(e,t,i){if(t&&"string"!=typeof t)i=t,t="";if("string"==typeof e)return $(e,i?i.treeObj.get(0).ownerDocument:null);else return $("#"+e.tId+t,i?i.treeObj:null)},getMDom:function(e,t,i){if(!t)return null;for(;t&&t.id!==e.treeId;){for(var n=0,r=i.length;t.tagName&&r>n;n++)if(tools.eqs(t.tagName,i[n].tagName)&&null!==t.getAttribute(i[n].attrName))return t;t=t.parentNode}return null},getNodeMainDom:function(e){return $(e).parent("li").get(0)||$(e).parentsUntil("li").parent().get(0)},isChildOrSelf:function(e,t){return $(e).closest("#"+t).length>0},uCanDo:function(e,t){return!0}},view={addNodes:function(e,t,i,n){if(!e.data.keep.leaf||!t||t.isParent){if(!tools.isArray(i))i=[i];if(e.data.simpleData.enable)i=data.transformTozTreeFormat(e,i);if(t){var r=$$(t,consts.id.SWITCH,e),o=$$(t,consts.id.ICON,e),a=$$(t,consts.id.UL,e);if(!t.open)view.replaceSwitchClass(t,r,consts.folder.CLOSE),view.replaceIcoClass(t,o,consts.folder.CLOSE),t.open=!1,a.css({display:"none"});if(data.addNodesData(e,t,i),view.createNodes(e,t.level+1,i,t),!n)view.expandCollapseParentNode(e,t,!0)}else data.addNodesData(e,data.getRoot(e),i),view.createNodes(e,0,i,null)}},appendNodes:function(e,t,i,n,r,o){if(!i)return[];for(var a=[],s=e.data.key.children,l=0,u=i.length;u>l;l++){var c=i[l];if(r){var d=n?n:data.getRoot(e),f=d[s],h=f.length==i.length&&0==l,p=l==i.length-1;data.initNode(e,t,c,n,h,p,o),data.addNodeCache(e,c)}var m=[];if(c[s]&&c[s].length>0)m=view.appendNodes(e,t+1,c[s],c,r,o&&c.open);if(o){if(view.makeDOMNodeMainBefore(a,e,c),view.makeDOMNodeLine(a,e,c),data.getBeforeA(e,c,a),view.makeDOMNodeNameBefore(a,e,c),data.getInnerBeforeA(e,c,a),view.makeDOMNodeIcon(a,e,c),data.getInnerAfterA(e,c,a),view.makeDOMNodeNameAfter(a,e,c),data.getAfterA(e,c,a),c.isParent&&c.open)view.makeUlHtml(e,c,a,m.join(""));view.makeDOMNodeMainAfter(a,e,c),data.addCreatedNode(e,c)}}return a},appendParentULDom:function(e,t){var i=[],n=$$(t,e);if(!n.get(0)&&t.parentTId)view.appendParentULDom(e,t.getParentNode()),n=$$(t,e);var r=$$(t,consts.id.UL,e);if(r.get(0))r.remove();var o=e.data.key.children,a=view.appendNodes(e,t.level+1,t[o],t,!1,!0);view.makeUlHtml(e,t,i,a.join("")),n.append(i.join(""))},asyncNode:function(setting,node,isSilent,callback){var i,l;if(node&&!node.isParent)return tools.apply(callback),!1;else if(node&&node.isAjaxing)return!1;else if(0==tools.apply(setting.callback.beforeAsync,[setting.treeId,node],!0))return tools.apply(callback),!1;if(node){node.isAjaxing=!0;var icoObj=$$(node,consts.id.ICON,setting);icoObj.attr({style:"","class":consts.className.BUTTON+" "+consts.className.ICO_LOADING})}var tmpParam={};for(i=0,l=setting.async.autoParam.length;node&&l>i;i++){var pKey=setting.async.autoParam[i].split("="),spKey=pKey;if(pKey.length>1)spKey=pKey[1],pKey=pKey[0];tmpParam[spKey]=node[pKey]}if(tools.isArray(setting.async.otherParam))for(i=0,l=setting.async.otherParam.length;l>i;i+=2)tmpParam[setting.async.otherParam[i]]=setting.async.otherParam[i+1];else for(var p in setting.async.otherParam)tmpParam[p]=setting.async.otherParam[p];var _tmpV=data.getRoot(setting)._ver;return $.ajax({contentType:setting.async.contentType,cache:!1,type:setting.async.type,url:tools.apply(setting.async.url,[setting.treeId,node],setting.async.url),data:tmpParam,dataType:setting.async.dataType,success:function(msg){if(_tmpV==data.getRoot(setting)._ver){var newNodes=[];try{if(!msg||0==msg.length)newNodes=[];else if("string"==typeof msg)newNodes=eval("("+msg+")");else newNodes=msg}catch(err){newNodes=msg}if(node)node.isAjaxing=null,node.zAsync=!0;if(view.setNodeLineIcos(setting,node),newNodes&&""!==newNodes)newNodes=tools.apply(setting.async.dataFilter,[setting.treeId,node,newNodes],newNodes),view.addNodes(setting,node,newNodes?tools.clone(newNodes):[],!!isSilent);else view.addNodes(setting,node,[],!!isSilent);setting.treeObj.trigger(consts.event.ASYNC_SUCCESS,[setting.treeId,node,msg]),tools.apply(callback)}},error:function(e,t,i){if(_tmpV==data.getRoot(setting)._ver){if(node)node.isAjaxing=null;view.setNodeLineIcos(setting,node),setting.treeObj.trigger(consts.event.ASYNC_ERROR,[setting.treeId,node,e,t,i])}}}),!0},cancelPreSelectedNode:function(e,t){for(var i=data.getRoot(e).curSelectedList,n=0,r=i.length-1;r>=n;r--)if(!t||t===i[r])if($$(i[r],consts.id.A,e).removeClass(consts.node.CURSELECTED),t){data.removeSelectedNode(e,t);break}if(!t)data.getRoot(e).curSelectedList=[]},createNodeCallback:function(e){if(e.callback.onNodeCreated||e.view.addDiyDom)for(var t=data.getRoot(e);t.createdNodes.length>0;){var i=t.createdNodes.shift();if(tools.apply(e.view.addDiyDom,[e.treeId,i]),e.callback.onNodeCreated)e.treeObj.trigger(consts.event.NODECREATED,[e.treeId,i])}},createNodes:function(e,t,i,n){if(i&&0!=i.length){var r=data.getRoot(e),o=e.data.key.children,a=!n||n.open||!!$$(n[o][0],e).get(0);r.createdNodes=[];var s=view.appendNodes(e,t,i,n,!0,a);if(!n)e.treeObj.append(s.join(""));else{var l=$$(n,consts.id.UL,e);if(l.get(0))l.append(s.join(""))}view.createNodeCallback(e)}},destroy:function(e){if(e)data.initCache(e),data.initRoot(e),event.unbindTree(e),event.unbindEvent(e),e.treeObj.empty(),delete settings[e.treeId]},expandCollapseNode:function(e,t,i,n,r){var o=data.getRoot(e),a=e.data.key.children;if(!t)return void tools.apply(r,[]);if(o.expandTriggerFlag){var s=r;r=function(){if(s)s();if(t.open)e.treeObj.trigger(consts.event.EXPAND,[e.treeId,t]);else e.treeObj.trigger(consts.event.COLLAPSE,[e.treeId,t])},o.expandTriggerFlag=!1}if(!t.open&&t.isParent&&(!$$(t,consts.id.UL,e).get(0)||t[a]&&t[a].length>0&&!$$(t[a][0],e).get(0)))view.appendParentULDom(e,t),view.createNodeCallback(e);if(t.open==i)return void tools.apply(r,[]);var l=$$(t,consts.id.UL,e),u=$$(t,consts.id.SWITCH,e),c=$$(t,consts.id.ICON,e);if(t.isParent){if(t.open=!t.open,t.iconOpen&&t.iconClose)c.attr("style",view.makeNodeIcoStyle(e,t));if(t.open)if(view.replaceSwitchClass(t,u,consts.folder.OPEN),view.replaceIcoClass(t,c,consts.folder.OPEN),0==n||""==e.view.expandSpeed)l.show(),tools.apply(r,[]);else if(t[a]&&t[a].length>0)l.slideDown(e.view.expandSpeed,r);else l.show(),tools.apply(r,[]);else if(view.replaceSwitchClass(t,u,consts.folder.CLOSE),view.replaceIcoClass(t,c,consts.folder.CLOSE),0==n||""==e.view.expandSpeed||!(t[a]&&t[a].length>0))l.hide(),tools.apply(r,[]);else l.slideUp(e.view.expandSpeed,r)}else tools.apply(r,[])},expandCollapseParentNode:function(e,t,i,n,r){if(t){if(!t.parentTId)return void view.expandCollapseNode(e,t,i,n,r);else view.expandCollapseNode(e,t,i,n);if(t.parentTId)view.expandCollapseParentNode(e,t.getParentNode(),i,n,r)}},expandCollapseSonNode:function(e,t,i,n,r){var o=data.getRoot(e),a=e.data.key.children,s=t?t[a]:o[a],l=t?!1:n,u=data.getRoot(e).expandTriggerFlag;if(data.getRoot(e).expandTriggerFlag=!1,s)for(var c=0,d=s.length;d>c;c++)if(s[c])view.expandCollapseSonNode(e,s[c],i,l);data.getRoot(e).expandTriggerFlag=u,view.expandCollapseNode(e,t,i,n,r)},makeDOMNodeIcon:function(e,t,i){var n=data.getNodeName(t,i),r=t.view.nameIsHTML?n:n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");e.push("<span id='",i.tId,consts.id.ICON,"' title='' treeNode",consts.id.ICON," class='",view.makeNodeIcoClass(t,i),"' style='",view.makeNodeIcoStyle(t,i),"'></span><span id='",i.tId,consts.id.SPAN,"'>",r,"</span>")},makeDOMNodeLine:function(e,t,i){e.push("<span id='",i.tId,consts.id.SWITCH,"' title='' class='",view.makeNodeLineClass(t,i),"' treeNode",consts.id.SWITCH,"></span>")},makeDOMNodeMainAfter:function(e,t,i){e.push("</li>")},makeDOMNodeMainBefore:function(e,t,i){e.push("<li id='",i.tId,"' class='",consts.className.LEVEL,i.level,"' tabindex='0' hidefocus='true' treenode>")},makeDOMNodeNameAfter:function(e,t,i){e.push("</a>")},makeDOMNodeNameBefore:function(e,t,i){var n=data.getNodeTitle(t,i),r=view.makeNodeUrl(t,i),o=view.makeNodeFontCss(t,i),a=[];for(var s in o)a.push(s,":",o[s],";");if(e.push("<a id='",i.tId,consts.id.A,"' class='",consts.className.LEVEL,i.level,"' treeNode",consts.id.A,' onclick="',i.click||"",'" ',null!=r&&r.length>0?"href='"+r+"'":""," target='",view.makeNodeTarget(i),"' style='",a.join(""),"'"),tools.apply(t.view.showTitle,[t.treeId,i],t.view.showTitle)&&n)e.push("title='",n.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'");e.push(">")},makeNodeFontCss:function(e,t){var i=tools.apply(e.view.fontCss,[e.treeId,t],e.view.fontCss);return i&&"function"!=typeof i?i:{}},makeNodeIcoClass:function(e,t){var i=["ico"];if(!t.isAjaxing)if(i[0]=(t.iconSkin?t.iconSkin+"_":"")+i[0],t.isParent)i.push(t.open?consts.folder.OPEN:consts.folder.CLOSE);else i.push(consts.folder.DOCU);return consts.className.BUTTON+" "+i.join("_")},makeNodeIcoStyle:function(e,t){var i=[];if(!t.isAjaxing){var n=t.isParent&&t.iconOpen&&t.iconClose?t.open?t.iconOpen:t.iconClose:t.icon;if(n)i.push("background:url(",n,") 0 0 no-repeat;");if(0==e.view.showIcon||!tools.apply(e.view.showIcon,[e.treeId,t],!0))i.push("width:0px;height:0px;")}return i.join("")},makeNodeLineClass:function(e,t){var i=[];if(e.view.showLine)if(0==t.level&&t.isFirstNode&&t.isLastNode)i.push(consts.line.ROOT);else if(0==t.level&&t.isFirstNode)i.push(consts.line.ROOTS);else if(t.isLastNode)i.push(consts.line.BOTTOM);else i.push(consts.line.CENTER);else i.push(consts.line.NOLINE);if(t.isParent)i.push(t.open?consts.folder.OPEN:consts.folder.CLOSE);else i.push(consts.folder.DOCU);return view.makeNodeLineClassEx(t)+i.join("_")},makeNodeLineClassEx:function(e){return consts.className.BUTTON+" "+consts.className.LEVEL+e.level+" "+consts.className.SWITCH+" "},makeNodeTarget:function(e){return e.target||"_blank"},makeNodeUrl:function(e,t){var i=e.data.key.url;return t[i]?t[i]:null},makeUlHtml:function(e,t,i,n){i.push("<ul id='",t.tId,consts.id.UL,"' class='",consts.className.LEVEL,t.level," ",view.makeUlLineClass(e,t),"' style='display:",t.open?"block":"none","'>"),i.push(n),i.push("</ul>")},makeUlLineClass:function(e,t){return e.view.showLine&&!t.isLastNode?consts.line.LINE:""},removeChildNodes:function(e,t){if(t){var i=e.data.key.children,n=t[i];if(n){for(var r=0,o=n.length;o>r;r++)data.removeNodeCache(e,n[r]);if(data.removeSelectedNode(e),delete t[i],!e.data.keep.parent){t.isParent=!1,t.open=!1;var a=$$(t,consts.id.SWITCH,e),s=$$(t,consts.id.ICON,e);view.replaceSwitchClass(t,a,consts.folder.DOCU),view.replaceIcoClass(t,s,consts.folder.DOCU),$$(t,consts.id.UL,e).remove()}else $$(t,consts.id.UL,e).empty()}}},setFirstNode:function(e,t){var i=e.data.key.children,n=t[i].length;if(n>0)t[i][0].isFirstNode=!0},setLastNode:function(e,t){var i=e.data.key.children,n=t[i].length;if(n>0)t[i][n-1].isLastNode=!0},removeNode:function(e,t){var i=data.getRoot(e),n=e.data.key.children,r=t.parentTId?t.getParentNode():i;if(t.isFirstNode=!1,t.isLastNode=!1,t.getPreNode=function(){return null},t.getNextNode=function(){return null},data.getNodeCache(e,t.tId)){$$(t,e).remove(),data.removeNodeCache(e,t),data.removeSelectedNode(e,t);for(var o=0,a=r[n].length;a>o;o++)if(r[n][o].tId==t.tId){r[n].splice(o,1);break}view.setFirstNode(e,r),view.setLastNode(e,r);var s,l,u,c=r[n].length;if(!e.data.keep.parent&&0==c)r.isParent=!1,r.open=!1,s=$$(r,consts.id.UL,e),l=$$(r,consts.id.SWITCH,e),u=$$(r,consts.id.ICON,e),view.replaceSwitchClass(r,l,consts.folder.DOCU),view.replaceIcoClass(r,u,consts.folder.DOCU),s.css("display","none");else if(e.view.showLine&&c>0){var d=r[n][c-1];if(s=$$(d,consts.id.UL,e),l=$$(d,consts.id.SWITCH,e),u=$$(d,consts.id.ICON,e),r==i)if(1==r[n].length)view.replaceSwitchClass(d,l,consts.line.ROOT);else{var f=$$(r[n][0],consts.id.SWITCH,e);view.replaceSwitchClass(r[n][0],f,consts.line.ROOTS),view.replaceSwitchClass(d,l,consts.line.BOTTOM)}else view.replaceSwitchClass(d,l,consts.line.BOTTOM);s.removeClass(consts.line.LINE)}}},replaceIcoClass:function(e,t,i){if(t&&!e.isAjaxing){var n=t.attr("class");if(void 0!=n){var r=n.split("_");switch(i){case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:r[r.length-1]=i}t.attr("class",r.join("_"))}}},replaceSwitchClass:function(e,t,i){if(t){var n=t.attr("class");if(void 0!=n){var r=n.split("_");switch(i){case consts.line.ROOT:case consts.line.ROOTS:case consts.line.CENTER:case consts.line.BOTTOM:case consts.line.NOLINE:r[0]=view.makeNodeLineClassEx(e)+i;break;case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:r[1]=i}if(t.attr("class",r.join("_")),i!==consts.folder.DOCU)t.removeAttr("disabled");else t.attr("disabled","disabled")}}},selectNode:function(e,t,i){if(!i)view.cancelPreSelectedNode(e);$$(t,consts.id.A,e).addClass(consts.node.CURSELECTED),data.addSelectedNode(e,t)},setNodeFontCss:function(e,t){var i=$$(t,consts.id.A,e),n=view.makeNodeFontCss(e,t);if(n)i.css(n)},setNodeLineIcos:function(e,t){if(t){var i=$$(t,consts.id.SWITCH,e),n=$$(t,consts.id.UL,e),r=$$(t,consts.id.ICON,e),o=view.makeUlLineClass(e,t);if(0==o.length)n.removeClass(consts.line.LINE);else n.addClass(o);if(i.attr("class",view.makeNodeLineClass(e,t)),t.isParent)i.removeAttr("disabled");else i.attr("disabled","disabled");r.removeAttr("style"),r.attr("style",view.makeNodeIcoStyle(e,t)),r.attr("class",view.makeNodeIcoClass(e,t))}},setNodeName:function(e,t){var i=data.getNodeTitle(e,t),n=$$(t,consts.id.SPAN,e);if(n.empty(),e.view.nameIsHTML)n.html(data.getNodeName(e,t));else n.text(data.getNodeName(e,t));if(tools.apply(e.view.showTitle,[e.treeId,t],e.view.showTitle)){var r=$$(t,consts.id.A,e);r.attr("title",!i?"":i)}},setNodeTarget:function(e,t){var i=$$(t,consts.id.A,e);i.attr("target",view.makeNodeTarget(t))},setNodeUrl:function(e,t){var i=$$(t,consts.id.A,e),n=view.makeNodeUrl(e,t);if(null==n||0==n.length)i.removeAttr("href");else i.attr("href",n)},switchNode:function(e,t){if(t.open||!tools.canAsync(e,t))view.expandCollapseNode(e,t,!t.open);else if(e.async.enable){if(!view.asyncNode(e,t))return void view.expandCollapseNode(e,t,!t.open)}else if(t)view.expandCollapseNode(e,t,!t.open)}};$.fn.zTree={consts:_consts,_z:{tools:tools,view:view,event:event,data:data},getZTreeObj:function(e){var t=data.getZTreeTools(e);return t?t:null},destroy:function(e){if(e&&e.length>0)view.destroy(data.getSetting(e));else for(var t in settings)view.destroy(settings[t])},init:function(e,t,i){var n=tools.clone(_setting);if($.extend(!0,n,t),n.treeId=e.attr("id"),n.treeObj=e,n.treeObj.empty(),settings[n.treeId]=n,"undefined"==typeof document.body.style.maxHeight)n.view.expandSpeed="";data.initRoot(n);var r=data.getRoot(n),o=n.data.key.children;if(i=i?tools.clone(tools.isArray(i)?i:[i]):[],n.data.simpleData.enable)r[o]=data.transformTozTreeFormat(n,i);else r[o]=i;data.initCache(n),event.unbindTree(n),event.bindTree(n),event.unbindEvent(n),event.bindEvent(n);var a={setting:n,addNodes:function(e,t,i){function r(){view.addNodes(n,e,o,1==i)}if(!t)return null;if(!e)e=null;if(e&&!e.isParent&&n.data.keep.leaf)return null;var o=tools.clone(tools.isArray(t)?t:[t]);if(tools.canAsync(n,e))view.asyncNode(n,e,i,r);else r();return o},cancelSelectedNode:function(e){view.cancelPreSelectedNode(n,e)},destroy:function(){view.destroy(n)},expandAll:function(e){return e=!!e,view.expandCollapseSonNode(n,null,e,!0),e},expandNode:function(e,t,i,r,o){if(!e||!e.isParent)return null;if(t!==!0&&t!==!1)t=!e.open;if(o=!!o,o&&t&&0==tools.apply(n.callback.beforeExpand,[n.treeId,e],!0))return null;else if(o&&!t&&0==tools.apply(n.callback.beforeCollapse,[n.treeId,e],!0))return null;if(t&&e.parentTId)view.expandCollapseParentNode(n,e.getParentNode(),t,!1);if(t===e.open&&!i)return null;if(data.getRoot(n).expandTriggerFlag=o,!tools.canAsync(n,e)&&i)view.expandCollapseSonNode(n,e,t,!0,function(){if(r!==!1)try{$$(e,n).focus().blur()}catch(t){}});else if(e.open=!t,view.switchNode(this.setting,e),r!==!1)try{$$(e,n).focus().blur()}catch(a){}return t},getNodes:function(){return data.getNodes(n)},getNodeByParam:function(e,t,i){if(!e)return null;else return data.getNodeByParam(n,i?i[n.data.key.children]:data.getNodes(n),e,t)},getNodeByTId:function(e){return data.getNodeCache(n,e)},getNodesByParam:function(e,t,i){if(!e)return null;else return data.getNodesByParam(n,i?i[n.data.key.children]:data.getNodes(n),e,t)},getNodesByParamFuzzy:function(e,t,i){if(!e)return null;else return data.getNodesByParamFuzzy(n,i?i[n.data.key.children]:data.getNodes(n),e,t)},getNodesByFilter:function(e,t,i,r){if(t=!!t,!e||"function"!=typeof e)return t?null:[];else return data.getNodesByFilter(n,i?i[n.data.key.children]:data.getNodes(n),e,t,r)},getNodeIndex:function(e){if(!e)return null;for(var t=n.data.key.children,i=e.parentTId?e.getParentNode():data.getRoot(n),r=0,o=i[t].length;o>r;r++)if(i[t][r]==e)return r;return-1},getSelectedNodes:function(){for(var e=[],t=data.getRoot(n).curSelectedList,i=0,r=t.length;r>i;i++)e.push(t[i]);return e},isSelectedNode:function(e){return data.isSelectedNode(n,e)},reAsyncChildNodes:function(e,t,i){if(this.setting.async.enable){var r=!e;if(r)e=data.getRoot(n);if("refresh"==t){for(var o=this.setting.data.key.children,a=0,s=e[o]?e[o].length:0;s>a;a++)data.removeNodeCache(n,e[o][a]);if(data.removeSelectedNode(n),e[o]=[],r)this.setting.treeObj.empty();else{var l=$$(e,consts.id.UL,n);l.empty()}}view.asyncNode(this.setting,r?null:e,!!i)}},refresh:function(){this.setting.treeObj.empty();var e=data.getRoot(n),t=e[n.data.key.children];data.initRoot(n),e[n.data.key.children]=t,data.initCache(n),view.createNodes(n,0,e[n.data.key.children])},removeChildNodes:function(e){if(!e)return null;var t=n.data.key.children,i=e[t];return view.removeChildNodes(n,e),i?i:null},removeNode:function(e,t){if(e)if(t=!!t,!t||0!=tools.apply(n.callback.beforeRemove,[n.treeId,e],!0))if(view.removeNode(n,e),t)this.setting.treeObj.trigger(consts.event.REMOVE,[n.treeId,e])},selectNode:function(e,t){if(e)if(tools.uCanDo(n)){if(t=n.view.selectedMulti&&t,e.parentTId)view.expandCollapseParentNode(n,e.getParentNode(),!0,!1,function(){try{$$(e,n).focus().blur()}catch(t){}});else try{$$(e,n).focus().blur()}catch(i){}view.selectNode(n,e,t)}},transformTozTreeNodes:function(e){return data.transformTozTreeFormat(n,e)},transformToArray:function(e){return data.transformToArrayFormat(n,e);
},updateNode:function(e,t){if(e){var i=$$(e,n);if(i.get(0)&&tools.uCanDo(n))view.setNodeName(n,e),view.setNodeTarget(n,e),view.setNodeUrl(n,e),view.setNodeLineIcos(n,e),view.setNodeFontCss(n,e)}}};if(r.treeTools=a,data.setZTreeTools(n,a),r[o]&&r[o].length>0)view.createNodes(n,0,r[o]);else if(n.async.enable&&n.async.url&&""!==n.async.url)view.asyncNode(n);return a}};var zt=$.fn.zTree,$$=tools.$,consts=zt.consts}(jQuery),function(e){var t={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},i={check:{enable:!1,autoCheckTrigger:!1,chkStyle:t.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:t.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}},n=function(e){var t=E.getRoot(e);t.radioCheckedList=[]},r=function(e){},o=function(e){var t=e.treeObj,i=b.event;t.bind(i.CHECK,function(t,i,n,r){t.srcEvent=i,y.apply(e.callback.onCheck,[t,n,r])})},a=function(e){var t=e.treeObj,i=b.event;t.unbind(i.CHECK)},s=function(e){var t=e.target,i=E.getSetting(e.data.treeId),n="",r=null,o="",a="",s=null,l=null;if(y.eqs(e.type,"mouseover")){if(i.check.enable&&y.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+b.id.CHECK))n=y.getNodeMainDom(t).id,o="mouseoverCheck"}else if(y.eqs(e.type,"mouseout")){if(i.check.enable&&y.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+b.id.CHECK))n=y.getNodeMainDom(t).id,o="mouseoutCheck"}else if(y.eqs(e.type,"click"))if(i.check.enable&&y.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+b.id.CHECK))n=y.getNodeMainDom(t).id,o="checkNode";if(n.length>0)switch(r=E.getNodeCache(i,n),o){case"checkNode":s=h.onCheckNode;break;case"mouseoverCheck":s=h.onMouseoverCheck;break;case"mouseoutCheck":s=h.onMouseoutCheck}var u={stop:"checkNode"===o,node:r,nodeEventType:o,nodeEventCallback:s,treeEventType:a,treeEventCallback:l};return u},l=function(e,t,i,n,r,o,a){if(i){var s=e.data.key.checked;if("string"==typeof i[s])i[s]=y.eqs(i[s],"true");if(i[s]=!!i[s],i.checkedOld=i[s],"string"==typeof i.nocheck)i.nocheck=y.eqs(i.nocheck,"true");if(i.nocheck=!!i.nocheck||e.check.nocheckInherit&&n&&!!n.nocheck,"string"==typeof i.chkDisabled)i.chkDisabled=y.eqs(i.chkDisabled,"true");if(i.chkDisabled=!!i.chkDisabled||e.check.chkDisabledInherit&&n&&!!n.chkDisabled,"string"==typeof i.halfCheck)i.halfCheck=y.eqs(i.halfCheck,"true");if(i.halfCheck=!!i.halfCheck,i.check_Child_State=-1,i.check_Focus=!1,i.getCheckStatus=function(){return E.getCheckStatus(e,i)},e.check.chkStyle==b.radio.STYLE&&e.check.radioType==b.radio.TYPE_ALL&&i[s]){var l=E.getRoot(e);l.radioCheckedList.push(i)}}},u=function(e,t,i){e.data.key.checked;if(e.check.enable)E.makeChkFlag(e,t),i.push("<span ID='",t.tId,b.id.CHECK,"' class='",C.makeChkClass(e,t),"' treeNode",b.id.CHECK,t.nocheck===!0?" style='display:none;'":"","></span>")},c=function(e,t){t.checkNode=function(e,t,i,n){var r=this.setting.data.key.checked;if(e.chkDisabled!==!0){if(t!==!0&&t!==!1)t=!e[r];if(n=!!n,e[r]!==t||i){if(n&&0==y.apply(this.setting.callback.beforeCheck,[this.setting.treeId,e],!0))return;if(y.uCanDo(this.setting)&&this.setting.check.enable&&e.nocheck!==!0){e[r]=t;var o=x(e,b.id.CHECK,this.setting);if(i||this.setting.check.chkStyle===b.radio.STYLE)C.checkNodeRelation(this.setting,e);if(C.setChkClass(this.setting,o,e),C.repairParentChkClassWithSelf(this.setting,e),n)this.setting.treeObj.trigger(b.event.CHECK,[null,this.setting.treeId,e])}}}},t.checkAllNodes=function(e){C.repairAllChk(this.setting,!!e)},t.getCheckedNodes=function(e){var t=this.setting.data.key.children;return e=e!==!1,E.getTreeCheckedNodes(this.setting,E.getRoot(this.setting)[t],e)},t.getChangeCheckedNodes=function(){var e=this.setting.data.key.children;return E.getTreeChangeCheckedNodes(this.setting,E.getRoot(this.setting)[e])},t.setChkDisabled=function(e,t,i,n){t=!!t,i=!!i,n=!!n,C.repairSonChkDisabled(this.setting,e,t,n),C.repairParentChkDisabled(this.setting,e.getParentNode(),t,i)};var i=t.updateNode;t.updateNode=function(e,n){if(i)i.apply(t,arguments);if(e&&this.setting.check.enable){var r=x(e,this.setting);if(r.get(0)&&y.uCanDo(this.setting)){var o=x(e,b.id.CHECK,this.setting);if(1==n||this.setting.check.chkStyle===b.radio.STYLE)C.checkNodeRelation(this.setting,e);C.setChkClass(this.setting,o,e),C.repairParentChkClassWithSelf(this.setting,e)}}}},d={getRadioCheckedList:function(e){for(var t=E.getRoot(e).radioCheckedList,i=0,n=t.length;n>i;i++)if(!E.getNodeCache(e,t[i].tId))t.splice(i,1),i--,n--;return t},getCheckStatus:function(e,t){if(!e.check.enable||t.nocheck||t.chkDisabled)return null;var i=e.data.key.checked,n={checked:t[i],half:t.halfCheck?t.halfCheck:e.check.chkStyle==b.radio.STYLE?2===t.check_Child_State:t[i]?t.check_Child_State>-1&&t.check_Child_State<2:t.check_Child_State>0};return n},getTreeCheckedNodes:function(e,t,i,n){if(!t)return[];var r=e.data.key.children,o=e.data.key.checked,a=i&&e.check.chkStyle==b.radio.STYLE&&e.check.radioType==b.radio.TYPE_ALL;n=!n?[]:n;for(var s=0,l=t.length;l>s;s++){if(t[s].nocheck!==!0&&t[s].chkDisabled!==!0&&t[s][o]==i)if(n.push(t[s]),a)break;if(E.getTreeCheckedNodes(e,t[s][r],i,n),a&&n.length>0)break}return n},getTreeChangeCheckedNodes:function(e,t,i){if(!t)return[];var n=e.data.key.children,r=e.data.key.checked;i=!i?[]:i;for(var o=0,a=t.length;a>o;o++){if(t[o].nocheck!==!0&&t[o].chkDisabled!==!0&&t[o][r]!=t[o].checkedOld)i.push(t[o]);E.getTreeChangeCheckedNodes(e,t[o][n],i)}return i},makeChkFlag:function(e,t){if(t){var i=e.data.key.children,n=e.data.key.checked,r=-1;if(t[i])for(var o=0,a=t[i].length;a>o;o++){var s=t[i][o],l=-1;if(e.check.chkStyle==b.radio.STYLE){if(s.nocheck===!0||s.chkDisabled===!0)l=s.check_Child_State;else if(s.halfCheck===!0)l=2;else if(s[n])l=2;else l=s.check_Child_State>0?2:0;if(2==l){r=2;break}else if(0==l)r=0}else if(e.check.chkStyle==b.checkbox.STYLE){if(s.nocheck===!0||s.chkDisabled===!0)l=s.check_Child_State;else if(s.halfCheck===!0)l=1;else if(s[n])l=-1===s.check_Child_State||2===s.check_Child_State?2:1;else l=s.check_Child_State>0?1:0;if(1===l){r=1;break}else if(2===l&&r>-1&&o>0&&l!==r){r=1;break}else if(2===r&&l>-1&&2>l){r=1;break}else if(l>-1)r=l}}t.check_Child_State=r}}},f={},h={onCheckNode:function(e,t){if(t.chkDisabled===!0)return!1;var i=E.getSetting(e.data.treeId),n=i.data.key.checked;if(0==y.apply(i.callback.beforeCheck,[i.treeId,t],!0))return!0;t[n]=!t[n],C.checkNodeRelation(i,t);var r=x(t,b.id.CHECK,i);return C.setChkClass(i,r,t),C.repairParentChkClassWithSelf(i,t),i.treeObj.trigger(b.event.CHECK,[e,i.treeId,t]),!0},onMouseoverCheck:function(e,t){if(t.chkDisabled===!0)return!1;var i=E.getSetting(e.data.treeId),n=x(t,b.id.CHECK,i);return t.check_Focus=!0,C.setChkClass(i,n,t),!0},onMouseoutCheck:function(e,t){if(t.chkDisabled===!0)return!1;var i=E.getSetting(e.data.treeId),n=x(t,b.id.CHECK,i);return t.check_Focus=!1,C.setChkClass(i,n,t),!0}},p={},m={checkNodeRelation:function(e,t){var i,n,r,o=e.data.key.children,a=e.data.key.checked,s=b.radio;if(e.check.chkStyle==s.STYLE){var l=E.getRadioCheckedList(e);if(t[a])if(e.check.radioType==s.TYPE_ALL){for(n=l.length-1;n>=0;n--)if(i=l[n],i[a]&&i!=t)if(i[a]=!1,l.splice(n,1),C.setChkClass(e,x(i,b.id.CHECK,e),i),i.parentTId!=t.parentTId)C.repairParentChkClassWithSelf(e,i);l.push(t)}else{var u=t.parentTId?t.getParentNode():E.getRoot(e);for(n=0,r=u[o].length;r>n;n++)if(i=u[o][n],i[a]&&i!=t)i[a]=!1,C.setChkClass(e,x(i,b.id.CHECK,e),i)}else if(e.check.radioType==s.TYPE_ALL)for(n=0,r=l.length;r>n;n++)if(t==l[n]){l.splice(n,1);break}}else{if(t[a]&&(!t[o]||0==t[o].length||e.check.chkboxType.Y.indexOf("s")>-1))C.setSonNodeCheckBox(e,t,!0);if(!t[a]&&(!t[o]||0==t[o].length||e.check.chkboxType.N.indexOf("s")>-1))C.setSonNodeCheckBox(e,t,!1);if(t[a]&&e.check.chkboxType.Y.indexOf("p")>-1)C.setParentNodeCheckBox(e,t,!0);if(!t[a]&&e.check.chkboxType.N.indexOf("p")>-1)C.setParentNodeCheckBox(e,t,!1)}},makeChkClass:function(e,t){var i=e.data.key.checked,n=b.checkbox,r=b.radio,o="";if(t.chkDisabled===!0)o=n.DISABLED;else if(t.halfCheck)o=n.PART;else if(e.check.chkStyle==r.STYLE)o=t.check_Child_State<1?n.FULL:n.PART;else o=t[i]?2===t.check_Child_State||-1===t.check_Child_State?n.FULL:n.PART:t.check_Child_State<1?n.FULL:n.PART;var a=e.check.chkStyle+"_"+(t[i]?n.TRUE:n.FALSE)+"_"+o;return a=t.check_Focus&&t.chkDisabled!==!0?a+"_"+n.FOCUS:a,b.className.BUTTON+" "+n.DEFAULT+" "+a},repairAllChk:function(e,t){if(e.check.enable&&e.check.chkStyle===b.checkbox.STYLE)for(var i=e.data.key.checked,n=e.data.key.children,r=E.getRoot(e),o=0,a=r[n].length;a>o;o++){var s=r[n][o];if(s.nocheck!==!0&&s.chkDisabled!==!0)s[i]=t;C.setSonNodeCheckBox(e,s,t)}},repairChkClass:function(e,t){if(t)if(E.makeChkFlag(e,t),t.nocheck!==!0){var i=x(t,b.id.CHECK,e);C.setChkClass(e,i,t)}},repairParentChkClass:function(e,t){if(t&&t.parentTId){var i=t.getParentNode();C.repairChkClass(e,i),C.repairParentChkClass(e,i)}},repairParentChkClassWithSelf:function(e,t){if(t){var i=e.data.key.children;if(t[i]&&t[i].length>0)C.repairParentChkClass(e,t[i][0]);else C.repairParentChkClass(e,t)}},repairSonChkDisabled:function(e,t,i,n){if(t){var r=e.data.key.children;if(t.chkDisabled!=i)t.chkDisabled=i;if(C.repairChkClass(e,t),t[r]&&n)for(var o=0,a=t[r].length;a>o;o++){var s=t[r][o];C.repairSonChkDisabled(e,s,i,n)}}},repairParentChkDisabled:function(e,t,i,n){if(t){if(t.chkDisabled!=i&&n)t.chkDisabled=i;C.repairChkClass(e,t),C.repairParentChkDisabled(e,t.getParentNode(),i,n)}},setChkClass:function(e,t,i){if(t){if(i.nocheck===!0)t.hide();else t.show();t.attr("class",C.makeChkClass(e,i))}},setParentNodeCheckBox:function(e,t,i,n){var r=e.data.key.children,o=e.data.key.checked,a=x(t,b.id.CHECK,e);if(!n)n=t;if(E.makeChkFlag(e,t),t.nocheck!==!0&&t.chkDisabled!==!0)if(t[o]=i,C.setChkClass(e,a,t),e.check.autoCheckTrigger&&t!=n)e.treeObj.trigger(b.event.CHECK,[null,e.treeId,t]);if(t.parentTId){var s=!0;if(!i)for(var l=t.getParentNode()[r],u=0,c=l.length;c>u;u++)if(l[u].nocheck!==!0&&l[u].chkDisabled!==!0&&l[u][o]||(l[u].nocheck===!0||l[u].chkDisabled===!0)&&l[u].check_Child_State>0){s=!1;break}if(s)C.setParentNodeCheckBox(e,t.getParentNode(),i,n)}},setSonNodeCheckBox:function(e,t,i,n){if(t){var r=e.data.key.children,o=e.data.key.checked,a=x(t,b.id.CHECK,e);if(!n)n=t;var s=!1;if(t[r])for(var l=0,u=t[r].length;u>l&&t.chkDisabled!==!0;l++){var c=t[r][l];if(C.setSonNodeCheckBox(e,c,i,n),c.chkDisabled===!0)s=!0}if(t!=E.getRoot(e)&&t.chkDisabled!==!0){if(s&&t.nocheck!==!0)E.makeChkFlag(e,t);if(t.nocheck!==!0&&t.chkDisabled!==!0){if(t[o]=i,!s)t.check_Child_State=t[r]&&t[r].length>0?i?2:0:-1}else t.check_Child_State=-1;if(C.setChkClass(e,a,t),e.check.autoCheckTrigger&&t!=n&&t.nocheck!==!0&&t.chkDisabled!==!0)e.treeObj.trigger(b.event.CHECK,[null,e.treeId,t])}}}},g={tools:p,view:m,event:f,data:d};e.extend(!0,e.fn.zTree.consts,t),e.extend(!0,e.fn.zTree._z,g);var v=e.fn.zTree,y=v._z.tools,b=v.consts,C=v._z.view,E=v._z.data,x=(v._z.event,y.$);E.exSetting(i),E.addInitBind(o),E.addInitUnBind(a),E.addInitCache(r),E.addInitNode(l),E.addInitProxy(s,!0),E.addInitRoot(n),E.addBeforeA(u),E.addZTreeTools(c);var D=C.createNodes;C.createNodes=function(e,t,i,n){if(D)D.apply(C,arguments);if(i)C.repairParentChkClassWithSelf(e,n)};var B=C.removeNode;C.removeNode=function(e,t){var i=t.getParentNode();if(B)B.apply(C,arguments);if(t&&i)C.repairChkClass(e,i),C.repairParentChkClass(e,i)};var w=C.appendNodes;C.appendNodes=function(e,t,i,n,r,o){var a="";if(w)a=w.apply(C,arguments);if(n)E.makeChkFlag(e,n);return a}}(jQuery),function(e){var t={event:{DRAG:"ztree_drag",DROP:"ztree_drop",RENAME:"ztree_rename",DRAGMOVE:"ztree_dragmove"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},i={edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDragMove:null,onDrop:null,onRename:null}},n=function(e){var t=C.getRoot(e),i=C.getRoots();t.curEditNode=null,t.curEditInput=null,t.curHoverNode=null,t.dragFlag=0,t.dragNodeShowBefore=[],t.dragMaskList=new Array,i.showHoverDom=!0},r=function(e){},o=function(e){var t=e.treeObj,i=y.event;t.bind(i.RENAME,function(t,i,n,r){v.apply(e.callback.onRename,[t,i,n,r])}),t.bind(i.DRAG,function(t,i,n,r){v.apply(e.callback.onDrag,[i,n,r])}),t.bind(i.DRAGMOVE,function(t,i,n,r){v.apply(e.callback.onDragMove,[i,n,r])}),t.bind(i.DROP,function(t,i,n,r,o,a,s){v.apply(e.callback.onDrop,[i,n,r,o,a,s])})},a=function(e){var t=e.treeObj,i=y.event;t.unbind(i.RENAME),t.unbind(i.DRAG),t.unbind(i.DRAGMOVE),t.unbind(i.DROP)},s=function(e){var t=e.target,i=C.getSetting(e.data.treeId),n=e.relatedTarget,r="",o=null,a="",s="",l=null,u=null,c=null;if(v.eqs(e.type,"mouseover")){if(c=v.getMDom(i,t,[{tagName:"a",attrName:"treeNode"+y.id.A}]))r=v.getNodeMainDom(c).id,a="hoverOverNode"}else if(v.eqs(e.type,"mouseout")){if(c=v.getMDom(i,n,[{tagName:"a",attrName:"treeNode"+y.id.A}]),!c)r="remove",a="hoverOutNode"}else if(v.eqs(e.type,"mousedown"))if(c=v.getMDom(i,t,[{tagName:"a",attrName:"treeNode"+y.id.A}]))r=v.getNodeMainDom(c).id,a="mousedownNode";if(r.length>0)switch(o=C.getNodeCache(i,r),a){case"mousedownNode":l=f.onMousedownNode;break;case"hoverOverNode":l=f.onHoverOverNode;break;case"hoverOutNode":l=f.onHoverOutNode}var d={stop:!1,node:o,nodeEventType:a,nodeEventCallback:l,treeEventType:s,treeEventCallback:u};return d},l=function(e,t,i,n,r,o,a){if(i)i.isHover=!1,i.editNameFlag=!1},u=function(e,t){t.cancelEditName=function(e){var t=C.getRoot(this.setting);if(t.curEditNode)b.cancelCurEditNode(this.setting,e?e:null,!0)},t.copyNode=function(e,t,i,n){function r(){b.addNodes(o.setting,e,[a],n)}if(!t)return null;if(e&&!e.isParent&&this.setting.data.keep.leaf&&i===y.move.TYPE_INNER)return null;var o=this,a=v.clone(t);if(!e)e=null,i=y.move.TYPE_INNER;if(i==y.move.TYPE_INNER)if(v.canAsync(this.setting,e))b.asyncNode(this.setting,e,n,r);else r();else b.addNodes(this.setting,e.parentNode,[a],n),b.moveNode(this.setting,e,a,i,!1,n);return a},t.editName=function(e){if(e&&e.tId&&e===C.getNodeCache(this.setting,e.tId)){if(e.parentTId)b.expandCollapseParentNode(this.setting,e.getParentNode(),!0);b.editNode(this.setting,e)}},t.moveNode=function(e,t,i,n){function r(){b.moveNode(o.setting,e,t,i,!1,n)}if(!t)return t;if(e&&!e.isParent&&this.setting.data.keep.leaf&&i===y.move.TYPE_INNER)return null;else if(e&&(t.parentTId==e.tId&&i==y.move.TYPE_INNER||E(t,this.setting).find("#"+e.tId).length>0))return null;else if(!e)e=null;var o=this;if(v.canAsync(this.setting,e)&&i===y.move.TYPE_INNER)b.asyncNode(this.setting,e,n,r);else r();return t},t.setEditable=function(e){return this.setting.edit.enable=e,this.refresh()}},c={setSonNodeLevel:function(e,t,i){if(i){var n=e.data.key.children;if(i.level=t?t.level+1:0,i[n])for(var r=0,o=i[n].length;o>r;r++)if(i[n][r])C.setSonNodeLevel(e,i,i[n][r])}}},d={},f={onHoverOverNode:function(e,t){var i=C.getSetting(e.data.treeId),n=C.getRoot(i);if(n.curHoverNode!=t)f.onHoverOutNode(e);n.curHoverNode=t,b.addHoverDom(i,t)},onHoverOutNode:function(e,t){var i=C.getSetting(e.data.treeId),n=C.getRoot(i);if(n.curHoverNode&&!C.isSelectedNode(i,n.curHoverNode))b.removeTreeDom(i,n.curHoverNode),n.curHoverNode=null},onMousedownNode:function(i,n){function r(i){if(0==c.dragFlag&&Math.abs(R-i.clientX)<u.edit.drag.minMoveSize&&Math.abs(I-i.clientY)<u.edit.drag.minMoveSize)return!0;var n,r,a,s,l,f=u.data.key.children;if(A.css("cursor","pointer"),0==c.dragFlag){if(0==v.apply(u.callback.beforeDrag,[u.treeId,p],!0))return o(i),!0;for(n=0,r=p.length;r>n;n++){if(0==n)c.dragNodeShowBefore=[];if(a=p[n],a.isParent&&a.open)b.expandCollapseNode(u,a,!a.open),c.dragNodeShowBefore[a.tId]=!0;else c.dragNodeShowBefore[a.tId]=!1}c.dragFlag=1,d.showHoverDom=!1,v.showIfameMask(u,!0);var h=!0,k=-1;if(p.length>1){var M=p[0].parentTId?p[0].getParentNode()[f]:C.getNodes(u);for(l=[],n=0,r=M.length;r>n;n++){if(void 0!==c.dragNodeShowBefore[M[n].tId]){if(h&&k>-1&&k+1!==n)h=!1;l.push(M[n]),k=n}if(p.length===l.length){p=l;break}}}if(h)D=p[0].getPreNode(),B=p[p.length-1].getNextNode();for(m=E("<ul class='zTreeDragUL'></ul>",u),n=0,r=p.length;r>n;n++)if(a=p[n],a.editNameFlag=!1,b.selectNode(u,a,n>0),b.removeTreeDom(u,a),!(n>u.edit.drag.maxShowNodeNum-1)){if(s=E("<li id='"+a.tId+"_tmp'></li>",u),s.append(E(a,y.id.A,u).clone()),s.css("padding","0"),s.children("#"+a.tId+y.id.A).removeClass(y.node.CURSELECTED),m.append(s),n==u.edit.drag.maxShowNodeNum-1)s=E("<li id='"+a.tId+"_moretmp'><a>  ...  </a></li>",u),m.append(s)}else;m.attr("id",p[0].tId+y.id.UL+"_tmp"),m.addClass(u.treeObj.attr("class")),m.appendTo(A),g=E("<span class='tmpzTreeMove_arrow'></span>",u),g.attr("id","zTreeMove_arrow_tmp"),g.appendTo(A),u.treeObj.trigger(y.event.DRAG,[i,u.treeId,p])}if(1==c.dragFlag){if(x&&g.attr("id")==i.target.id&&_&&i.clientX+w.scrollLeft()+2>e("#"+_+y.id.A,x).offset().left){var U=e("#"+_+y.id.A,x);i.target=U.length>0?U.get(0):i.target}else if(x)if(x.removeClass(y.node.TMPTARGET_TREE),_)e("#"+_+y.id.A,x).removeClass(y.node.TMPTARGET_NODE+"_"+y.move.TYPE_PREV).removeClass(y.node.TMPTARGET_NODE+"_"+t.move.TYPE_NEXT).removeClass(y.node.TMPTARGET_NODE+"_"+t.move.TYPE_INNER);x=null,_=null,F=!1,T=u;var O=C.getSettings();for(var H in O)if(O[H].treeId&&O[H].edit.enable&&O[H].treeId!=u.treeId&&(i.target.id==O[H].treeId||e(i.target).parents("#"+O[H].treeId).length>0))F=!0,T=O[H];var j=w.scrollTop(),z=w.scrollLeft(),q=T.treeObj.offset(),$=T.treeObj.get(0).scrollHeight,V=T.treeObj.get(0).scrollWidth,W=i.clientY+j-q.top,G=T.treeObj.height()+q.top-i.clientY-j,X=i.clientX+z-q.left,Y=T.treeObj.width()+q.left-i.clientX-z,Q=W<u.edit.drag.borderMax&&W>u.edit.drag.borderMin,K=G<u.edit.drag.borderMax&&G>u.edit.drag.borderMin,J=X<u.edit.drag.borderMax&&X>u.edit.drag.borderMin,Z=Y<u.edit.drag.borderMax&&Y>u.edit.drag.borderMin,ee=W>u.edit.drag.borderMin&&G>u.edit.drag.borderMin&&X>u.edit.drag.borderMin&&Y>u.edit.drag.borderMin,te=Q&&T.treeObj.scrollTop()<=0,ie=K&&T.treeObj.scrollTop()+T.treeObj.height()+10>=$,ne=J&&T.treeObj.scrollLeft()<=0,re=Z&&T.treeObj.scrollLeft()+T.treeObj.width()+10>=V;if(i.target&&v.isChildOrSelf(i.target,T.treeId)){for(var oe=i.target;oe&&oe.tagName&&!v.eqs(oe.tagName,"li")&&oe.id!=T.treeId;)oe=oe.parentNode;var ae=!0;for(n=0,r=p.length;r>n;n++)if(a=p[n],oe.id===a.tId){ae=!1;break}else if(E(a,u).find("#"+oe.id).length>0){ae=!1;break}if(ae&&i.target&&v.isChildOrSelf(i.target,oe.id+y.id.A))x=e(oe),_=oe.id}if(a=p[0],ee&&v.isChildOrSelf(i.target,T.treeId)){if(!x&&(i.target.id==T.treeId||te||ie||ne||re)&&(F||!F&&a.parentTId))x=T.treeObj;if(Q)T.treeObj.scrollTop(T.treeObj.scrollTop()-10);else if(K)T.treeObj.scrollTop(T.treeObj.scrollTop()+10);if(J)T.treeObj.scrollLeft(T.treeObj.scrollLeft()-10);else if(Z)T.treeObj.scrollLeft(T.treeObj.scrollLeft()+10);if(x&&x!=T.treeObj&&x.offset().left<T.treeObj.offset().left)T.treeObj.scrollLeft(T.treeObj.scrollLeft()+x.offset().left-T.treeObj.offset().left)}m.css({top:i.clientY+j+3+"px",left:i.clientX+z+3+"px"});var se=0,le=0;if(x&&x.attr("id")!=T.treeId){var ue=null==_?null:C.getNodeCache(T,_),ce=(i.ctrlKey||i.metaKey)&&u.edit.drag.isMove&&u.edit.drag.isCopy||!u.edit.drag.isMove&&u.edit.drag.isCopy,de=!(!D||_!==D.tId),fe=!(!B||_!==B.tId),he=a.parentTId&&a.parentTId==_,pe=(ce||!fe)&&v.apply(T.edit.drag.prev,[T.treeId,p,ue],!!T.edit.drag.prev),me=(ce||!de)&&v.apply(T.edit.drag.next,[T.treeId,p,ue],!!T.edit.drag.next),ge=(ce||!he)&&!(T.data.keep.leaf&&!ue.isParent)&&v.apply(T.edit.drag.inner,[T.treeId,p,ue],!!T.edit.drag.inner);if(!pe&&!me&&!ge){if(x=null,_="",L=y.move.TYPE_INNER,g.css({display:"none"}),window.zTreeMoveTimer)clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null}else{var ve=e("#"+_+y.id.A,x),ye=ue.isLastNode?null:e("#"+ue.getNextNode().tId+y.id.A,x.next()),be=ve.offset().top,Ce=ve.offset().left,Ee=pe?ge?.25:me?.5:1:-1,xe=me?ge?.75:pe?.5:0:-1,De=(i.clientY+j-be)/ve.height();if((1==Ee||Ee>=De&&De>=-.2)&&pe)se=1-g.width(),le=be-g.height()/2,L=y.move.TYPE_PREV;else if((0==xe||De>=xe&&1.2>=De)&&me)se=1-g.width(),le=null==ye||ue.isParent&&ue.open?be+ve.height()-g.height()/2:ye.offset().top-g.height()/2,L=y.move.TYPE_NEXT;else se=5-g.width(),le=be,L=y.move.TYPE_INNER;if(g.css({display:"block",top:le+"px",left:Ce+se+"px"}),ve.addClass(y.node.TMPTARGET_NODE+"_"+L),S!=_||N!=L)P=(new Date).getTime();if(ue&&ue.isParent&&L==y.move.TYPE_INNER){var Be=!0;if(window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==ue.tId)clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null;else if(window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===ue.tId)Be=!1;if(Be)window.zTreeMoveTimer=setTimeout(function(){if(L==y.move.TYPE_INNER)if(ue&&ue.isParent&&!ue.open&&(new Date).getTime()-P>T.edit.drag.autoOpenTime&&v.apply(T.callback.beforeDragOpen,[T.treeId,ue],!0))if(b.switchNode(T,ue),T.edit.drag.autoExpandTrigger)T.treeObj.trigger(y.event.EXPAND,[T.treeId,ue])},T.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=ue.tId}}}else{if(L=y.move.TYPE_INNER,x&&v.apply(T.edit.drag.inner,[T.treeId,p,null],!!T.edit.drag.inner))x.addClass(y.node.TMPTARGET_TREE);else x=null;if(g.css({display:"none"}),window.zTreeMoveTimer)clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null}S=_,N=L,u.treeObj.trigger(y.event.DRAGMOVE,[i,u.treeId,p])}return!1}function o(i){function n(){if(F){if(!h)for(var e=0,t=p.length;t>e;e++)b.removeNode(u,p[e]);if(L==y.move.TYPE_INNER)b.addNodes(T,D,B);else if(b.addNodes(T,D.getParentNode(),B),L==y.move.TYPE_PREV)for(e=0,t=B.length;t>e;e++)b.moveNode(T,D,B[e],L,!1);else for(e=-1,t=B.length-1;t>e;t--)b.moveNode(T,D,B[t],L,!1)}else if(h&&L==y.move.TYPE_INNER)b.addNodes(T,D,B);else{if(h)b.addNodes(T,D.getParentNode(),B);if(L!=y.move.TYPE_NEXT)for(e=0,t=B.length;t>e;e++)b.moveNode(T,D,B[e],L,!1);else for(e=-1,t=B.length-1;t>e;t--)b.moveNode(T,D,B[t],L,!1)}b.selectNodes(T,B),E(B[0],u).focus().blur(),u.treeObj.trigger(y.event.DROP,[i,T.treeId,B,D,L,h])}if(window.zTreeMoveTimer)clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null;if(S=null,N=null,w.unbind("mousemove",r),w.unbind("mouseup",o),w.unbind("selectstart",a),A.css("cursor","auto"),x)if(x.removeClass(y.node.TMPTARGET_TREE),_)e("#"+_+y.id.A,x).removeClass(y.node.TMPTARGET_NODE+"_"+y.move.TYPE_PREV).removeClass(y.node.TMPTARGET_NODE+"_"+t.move.TYPE_NEXT).removeClass(y.node.TMPTARGET_NODE+"_"+t.move.TYPE_INNER);if(v.showIfameMask(u,!1),d.showHoverDom=!0,0!=c.dragFlag){c.dragFlag=0;var s,l,f;for(s=0,l=p.length;l>s;s++)if(f=p[s],f.isParent&&c.dragNodeShowBefore[f.tId]&&!f.open)b.expandCollapseNode(u,f,!f.open),delete c.dragNodeShowBefore[f.tId];if(m)m.remove();if(g)g.remove();var h=(i.ctrlKey||i.metaKey)&&u.edit.drag.isMove&&u.edit.drag.isCopy||!u.edit.drag.isMove&&u.edit.drag.isCopy;if(!h&&x&&_&&p[0].parentTId&&_==p[0].parentTId&&L==y.move.TYPE_INNER)x=null;if(x){var D=null==_?null:C.getNodeCache(T,_);if(0==v.apply(u.callback.beforeDrop,[T.treeId,p,D,L,h],!0))return void b.selectNodes(k,p);var B=h?v.clone(p):p;if(L==y.move.TYPE_INNER&&v.canAsync(T,D))b.asyncNode(T,D,!1,n);else n()}else b.selectNodes(k,p),u.treeObj.trigger(y.event.DROP,[i,u.treeId,p,null,null,null])}}function a(){return!1}var s,l,u=C.getSetting(i.data.treeId),c=C.getRoot(u),d=C.getRoots();if(2==i.button||!u.edit.enable||!u.edit.drag.isCopy&&!u.edit.drag.isMove)return!0;var f=i.target,h=C.getRoot(u).curSelectedList,p=[];if(!C.isSelectedNode(u,n))p=[n];else for(s=0,l=h.length;l>s;s++){if(h[s].editNameFlag&&v.eqs(f.tagName,"input")&&null!==f.getAttribute("treeNode"+y.id.INPUT))return!0;if(p.push(h[s]),p[0].parentTId!==h[s].parentTId){p=[n];break}}b.editNodeBlur=!0,b.cancelCurEditNode(u);var m,g,x,D,B,w=e(u.treeObj.get(0).ownerDocument),A=e(u.treeObj.get(0).ownerDocument.body),F=!1,T=u,k=u,S=null,N=null,_=null,L=y.move.TYPE_INNER,R=i.clientX,I=i.clientY,P=(new Date).getTime();if(v.uCanDo(u))w.bind("mousemove",r);if(w.bind("mouseup",o),w.bind("selectstart",a),i.preventDefault)i.preventDefault();return!0}},h={getAbs:function(e){var t=e.getBoundingClientRect(),i=document.body.scrollTop+document.documentElement.scrollTop,n=document.body.scrollLeft+document.documentElement.scrollLeft;return[t.left+n,t.top+i]},inputFocus:function(e){if(e.get(0))e.focus(),v.setCursorPosition(e.get(0),e.val().length)},inputSelect:function(e){if(e.get(0))e.focus(),e.select()},setCursorPosition:function(e,t){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,t);else if(e.createTextRange){var i=e.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",t),i.select()}},showIfameMask:function(e,t){for(var i=C.getRoot(e);i.dragMaskList.length>0;)i.dragMaskList[0].remove(),i.dragMaskList.shift();if(t)for(var n=E("iframe",e),r=0,o=n.length;o>r;r++){var a=n.get(r),s=v.getAbs(a),l=E("<div id='zTreeMask_"+r+"' class='zTreeMask' style='top:"+s[1]+"px; left:"+s[0]+"px; width:"+a.offsetWidth+"px; height:"+a.offsetHeight+"px;'></div>",e);l.appendTo(E("body",e)),i.dragMaskList.push(l)}}},p={addEditBtn:function(e,t){if(!(t.editNameFlag||E(t,y.id.EDIT,e).length>0))if(v.apply(e.edit.showRenameBtn,[e.treeId,t],e.edit.showRenameBtn)){var i=E(t,y.id.A,e),n="<span class='"+y.className.BUTTON+" edit' id='"+t.tId+y.id.EDIT+"' title='"+v.apply(e.edit.renameTitle,[e.treeId,t],e.edit.renameTitle)+"' treeNode"+y.id.EDIT+" style='display:none;'></span>";i.append(n),E(t,y.id.EDIT,e).bind("click",function(){if(!v.uCanDo(e)||0==v.apply(e.callback.beforeEditName,[e.treeId,t],!0))return!1;else return b.editNode(e,t),!1}).show()}},addRemoveBtn:function(e,t){if(!(t.editNameFlag||E(t,y.id.REMOVE,e).length>0))if(v.apply(e.edit.showRemoveBtn,[e.treeId,t],e.edit.showRemoveBtn)){var i=E(t,y.id.A,e),n="<span class='"+y.className.BUTTON+" remove' id='"+t.tId+y.id.REMOVE+"' title='"+v.apply(e.edit.removeTitle,[e.treeId,t],e.edit.removeTitle)+"' treeNode"+y.id.REMOVE+" style='display:none;'></span>";i.append(n),E(t,y.id.REMOVE,e).bind("click",function(){if(!v.uCanDo(e)||0==v.apply(e.callback.beforeRemove,[e.treeId,t],!0))return!1;else return b.removeNode(e,t),e.treeObj.trigger(y.event.REMOVE,[e.treeId,t]),!1}).bind("mousedown",function(e){return!0}).show()}},addHoverDom:function(e,t){if(C.getRoots().showHoverDom){if(t.isHover=!0,e.edit.enable)b.addEditBtn(e,t),b.addRemoveBtn(e,t);v.apply(e.view.addHoverDom,[e.treeId,t])}},cancelCurEditNode:function(e,t,i){var n=C.getRoot(e),r=e.data.key.name,o=n.curEditNode;if(o){var a=n.curEditInput,s=t?t:i?o[r]:a.val();if(v.apply(e.callback.beforeRename,[e.treeId,o,s,i],!0)===!1)return!1;else o[r]=s,e.treeObj.trigger(y.event.RENAME,[e.treeId,o,i]);var l=E(o,y.id.A,e);l.removeClass(y.node.CURSELECTED_EDIT),a.unbind(),b.setNodeName(e,o),o.editNameFlag=!1,n.curEditNode=null,n.curEditInput=null,b.selectNode(e,o,!1)}return n.noSelection=!0,!0},editNode:function(e,t){var i=C.getRoot(e);if(b.editNodeBlur=!1,C.isSelectedNode(e,t)&&i.curEditNode==t&&t.editNameFlag)return void setTimeout(function(){v.inputFocus(i.curEditInput)},0);var n=e.data.key.name;t.editNameFlag=!0,b.removeTreeDom(e,t),b.cancelCurEditNode(e),b.selectNode(e,t,!1),E(t,y.id.SPAN,e).html("<input type=text class='rename' id='"+t.tId+y.id.INPUT+"' treeNode"+y.id.INPUT+" >");var r=E(t,y.id.INPUT,e);if(r.attr("value",t[n]),e.edit.editNameSelectAll)v.inputSelect(r);else v.inputFocus(r);r.bind("blur",function(t){if(!b.editNodeBlur)b.cancelCurEditNode(e)}).bind("keydown",function(t){if("13"==t.keyCode)b.editNodeBlur=!0,b.cancelCurEditNode(e);else if("27"==t.keyCode)b.cancelCurEditNode(e,null,!0)}).bind("click",function(e){return!1}).bind("dblclick",function(e){return!1}),E(t,y.id.A,e).addClass(y.node.CURSELECTED_EDIT),i.curEditInput=r,i.noSelection=!1,i.curEditNode=t},moveNode:function(e,t,i,n,r,o){var a=C.getRoot(e),s=e.data.key.children;if(t!=i)if(!e.data.keep.leaf||!t||t.isParent||n!=y.move.TYPE_INNER){var l=i.parentTId?i.getParentNode():a,u=null===t||t==a;if(u&&null===t)t=a;if(u)n=y.move.TYPE_INNER;var c=t.parentTId?t.getParentNode():a;if(n!=y.move.TYPE_PREV&&n!=y.move.TYPE_NEXT)n=y.move.TYPE_INNER;if(n==y.move.TYPE_INNER)if(u)i.parentTId=null;else{if(!t.isParent)t.isParent=!0,t.open=!!t.open,b.setNodeLineIcos(e,t);i.parentTId=t.tId}var d,f;if(u)d=e.treeObj,f=d;else{if(!o&&n==y.move.TYPE_INNER)b.expandCollapseNode(e,t,!0,!1);else if(!o)b.expandCollapseNode(e,t.getParentNode(),!0,!1);if(d=E(t,e),f=E(t,y.id.UL,e),d.get(0)&&!f.get(0)){var h=[];b.makeUlHtml(e,t,h,""),d.append(h.join(""))}f=E(t,y.id.UL,e)}var p=E(i,e);if(!p.get(0))p=b.appendNodes(e,i.level,[i],null,!1,!0).join("");else if(!d.get(0))p.remove();if(f.get(0)&&n==y.move.TYPE_INNER)f.append(p);else if(d.get(0)&&n==y.move.TYPE_PREV)d.before(p);else if(d.get(0)&&n==y.move.TYPE_NEXT)d.after(p);var m,g,v=-1,x=0,D=null,B=null,w=i.level;if(i.isFirstNode){if(v=0,l[s].length>1)D=l[s][1],D.isFirstNode=!0}else if(i.isLastNode)v=l[s].length-1,D=l[s][v-1],D.isLastNode=!0;else for(m=0,g=l[s].length;g>m;m++)if(l[s][m].tId==i.tId){v=m;break}if(v>=0)l[s].splice(v,1);if(n!=y.move.TYPE_INNER)for(m=0,g=c[s].length;g>m;m++)if(c[s][m].tId==t.tId)x=m;if(n==y.move.TYPE_INNER){if(!t[s])t[s]=new Array;if(t[s].length>0)B=t[s][t[s].length-1],B.isLastNode=!1;t[s].splice(t[s].length,0,i),i.isLastNode=!0,i.isFirstNode=1==t[s].length}else if(t.isFirstNode&&n==y.move.TYPE_PREV)c[s].splice(x,0,i),B=t,B.isFirstNode=!1,i.parentTId=t.parentTId,i.isFirstNode=!0,i.isLastNode=!1;else if(t.isLastNode&&n==y.move.TYPE_NEXT)c[s].splice(x+1,0,i),B=t,B.isLastNode=!1,i.parentTId=t.parentTId,i.isFirstNode=!1,i.isLastNode=!0;else{if(n==y.move.TYPE_PREV)c[s].splice(x,0,i);else c[s].splice(x+1,0,i);i.parentTId=t.parentTId,i.isFirstNode=!1,i.isLastNode=!1}if(C.fixPIdKeyValue(e,i),C.setSonNodeLevel(e,i.getParentNode(),i),b.setNodeLineIcos(e,i),b.repairNodeLevelClass(e,i,w),!e.data.keep.parent&&l[s].length<1){l.isParent=!1,l.open=!1;var A=E(l,y.id.UL,e),F=E(l,y.id.SWITCH,e),T=E(l,y.id.ICON,e);b.replaceSwitchClass(l,F,y.folder.DOCU),b.replaceIcoClass(l,T,y.folder.DOCU),A.css("display","none")}else if(D)b.setNodeLineIcos(e,D);if(B)b.setNodeLineIcos(e,B);if(e.check&&e.check.enable&&b.repairChkClass)if(b.repairChkClass(e,l),b.repairParentChkClassWithSelf(e,l),l!=i.parent)b.repairParentChkClassWithSelf(e,i);if(!o)b.expandCollapseParentNode(e,i.getParentNode(),!0,r)}},removeEditBtn:function(e,t){E(t,y.id.EDIT,e).unbind().remove()},removeRemoveBtn:function(e,t){E(t,y.id.REMOVE,e).unbind().remove()},removeTreeDom:function(e,t){t.isHover=!1,b.removeEditBtn(e,t),b.removeRemoveBtn(e,t),v.apply(e.view.removeHoverDom,[e.treeId,t])},repairNodeLevelClass:function(e,t,i){if(i!==t.level){var n=E(t,e),r=E(t,y.id.A,e),o=E(t,y.id.UL,e),a=y.className.LEVEL+i,s=y.className.LEVEL+t.level;n.removeClass(a),n.addClass(s),r.removeClass(a),r.addClass(s),o.removeClass(a),o.addClass(s)}},selectNodes:function(e,t){for(var i=0,n=t.length;n>i;i++)b.selectNode(e,t[i],i>0)}},m={tools:h,view:p,event:d,data:c};e.extend(!0,e.fn.zTree.consts,t),e.extend(!0,e.fn.zTree._z,m);var g=e.fn.zTree,v=g._z.tools,y=g.consts,b=g._z.view,C=g._z.data,E=(g._z.event,v.$);C.exSetting(i),C.addInitBind(o),C.addInitUnBind(a),C.addInitCache(r),C.addInitNode(l),C.addInitProxy(s),C.addInitRoot(n),C.addZTreeTools(u);var x=b.cancelPreSelectedNode;b.cancelPreSelectedNode=function(e,t){for(var i=C.getRoot(e).curSelectedList,n=0,r=i.length;r>n;n++)if(!t||t===i[n])if(b.removeTreeDom(e,i[n]),t)break;if(x)x.apply(b,arguments)};var D=b.createNodes;b.createNodes=function(e,t,i,n){if(D)D.apply(b,arguments);if(i)if(b.repairParentChkClassWithSelf)b.repairParentChkClassWithSelf(e,n)};var B=b.makeNodeUrl;b.makeNodeUrl=function(e,t){return e.edit.enable?null:B.apply(b,arguments);
};var w=b.removeNode;b.removeNode=function(e,t){var i=C.getRoot(e);if(i.curEditNode===t)i.curEditNode=null;if(w)w.apply(b,arguments)};var A=b.selectNode;b.selectNode=function(e,t,i){var n=C.getRoot(e);if(C.isSelectedNode(e,t)&&n.curEditNode==t&&t.editNameFlag)return!1;if(A)A.apply(b,arguments);return b.addHoverDom(e,t),!0};var F=v.uCanDo;v.uCanDo=function(e,t){var i=C.getRoot(e);if(t&&(v.eqs(t.type,"mouseover")||v.eqs(t.type,"mouseout")||v.eqs(t.type,"mousedown")||v.eqs(t.type,"mouseup")))return!0;if(i.curEditNode)b.editNodeBlur=!1,i.curEditInput.focus();return!i.curEditNode&&(F?F.apply(b,arguments):!0)}}(jQuery);